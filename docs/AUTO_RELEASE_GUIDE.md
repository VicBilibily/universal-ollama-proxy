# 🚀 自动发布指南

本项目已配置完整的自动化 CI/CD 流程，**只需创建 GitHub
Release 即可自动构建和发布多平台程序包**。

## 📝 发布新版本（唯一推荐方式）

### 🎯 简单三步发布流程

1. **进入 GitHub 仓库**

   - 访问您的 GitHub 仓库页面
   - 点击右侧的 "Releases" 链接

2. **创建新 Release**

   - 点击 "Create a new release" 按钮
   - 在 "Choose a tag" 下拉框中输入新版本号（如：`v1.0.2`）
   - 填写 Release 标题（如：`Release v1.0.2`）
   - 在描述框中填写更新说明
   - 可选择是否为预发布版本
   - 点击 "Publish release"

3. **自动化构建完成！**
   - 🔄 Release Build 工作流自动触发
   - 🏗️ 自动构建所有平台二进制文件（Windows, Linux, macOS）
   - ✅ 自动验证构建产物完整性
   - 📦 自动生成压缩包
   - ⬆️ 自动上传到 Release 页面
   - ⏱️ 等待 3-5 分钟构建完成
   - 🎉 所有平台的程序包自动出现在 Release 页面

## ⚡ 自动化内容

每次创建 Release 后，系统自动完成：

### 📦 构建内容

- ✅ Windows x64 可执行文件 + 压缩包
- ✅ Windows ARM64 可执行文件 + 压缩包
- ✅ Linux x64 可执行文件 + tar.gz 包
- ✅ Linux ARM64 可执行文件 + tar.gz 包
- ✅ macOS x64 可执行文件 + tar.gz 包
- ✅ macOS ARM64 可执行文件 + tar.gz 包

### 🔍 质量保证

- ✅ 代码格式检查 (`npm run lint`)
- ✅ TypeScript 编译验证
- ✅ 二进制文件完整性验证
- ✅ 发布包内容检查
- ✅ 配置文件包含验证

### 📄 发布包内容

每个平台的压缩包都包含：

- 🗂️ 可执行文件
- ⚙️ 配置文件目录 (`config/`)
- 📝 环境变量示例 (`.env.example`)
- 📖 使用说明 (`README.md`)

## 🕐 构建时间

通常需要 3-5 分钟完成所有平台构建：

- **准备阶段**: ~30秒（依赖安装、代码检查）
- **构建阶段**: ~2-3分钟（多平台二进制文件生成）
- **打包阶段**: ~1分钟（创建压缩包、验证完整性）
- **上传阶段**: ~30秒（上传到 GitHub Release）

## 📊 监控构建状态

### 查看构建进度

1. 创建 Release 后，进入在 GitHub 仓库的 Actions 页面查看构建状态。
2. 查看 "Release Build and Deploy" 工作流运行状态
3. 点击运行详情查看实时日志

### 构建状态说明

- 🔄 **进行中**: 构建正在执行
- ✅ **成功**: 所有文件已生成并上传
- ❌ **失败**: 构建过程中出现错误

### 使用监控脚本

```bash
# 检查本地和远程构建状态
npm run monitor:actions

# 只检查本地状态
npm run monitor:actions --local
```

## 🚨 故障排除

### 常见问题

1. **构建失败**

   - 检查 Actions 日志了解具体错误
   - 确认代码没有语法错误
   - 验证依赖是否正确安装

2. **部分平台缺失**

   - 查看构建日志中的错误信息
   - 可能是特定平台构建工具问题
   - 重新触发构建通常可以解决

3. **上传失败**
   - 检查网络连接
   - 确认 GitHub Token 权限正确
   - 验证文件大小没有超过限制

### 重新构建

如果构建失败，可以：

1. 删除有问题的 Release
2. 重新创建相同版本的 Release
3. 或者使用手动触发工作流的方式

## 🎯 最佳实践

### 版本号规范

遵循 [语义化版本](https://semver.org/) 规范：

- `v1.0.1` - 修复 bug
- `v1.1.0` - 新增功能
- `v2.0.0` - 重大变更

### 发布说明

建议在 Release 描述中包含：

- 📝 主要更新内容
- 🆕 新增功能列表
- 🐛 修复的问题
- ⚠️ 重要注意事项
- 🔗 相关文档链接

### 测试建议

发布前建议：

- ✅ 在本地完整测试
- ✅ 运行 `npm run verify:releases` 验证
- ✅ 检查所有平台的功能
- ✅ 更新相关文档

## 📱 用户下载体验

用户下载流程：

1. 访问在 GitHub 仓库的 Releases 页面查看所有已发布的版本。
2. 选择最新版本
3. 根据操作系统下载对应文件：
   - Windows: `.zip` 文件
   - Linux/macOS: `.tar.gz` 文件
4. 解压后即可使用，无需安装 Node.js

---

🎉
**总结**：只需在 GitHub 上创建 Release，几分钟后所有平台的程序包就会自动生成完毕！
